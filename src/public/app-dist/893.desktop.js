(window.webpackJsonptrilium=window.webpackJsonptrilium||[]).push([[893],{8893:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>r});var n=o(8481),a=o(9806),d=o(3968),i=o(1035),c=o(2040),l=o(8003),m=o(8181),s=o(7112);const r=class{constructor(e,t){this.treeWidget=e,this.node=t}async show(e){s.Z.show({x:e.pageX,y:e.pageY,items:await this.getMenuItems(),selectMenuItemHandler:(e,t)=>this.selectMenuItemHandler(e,t)})}getNoteTypeItems(e){return[{title:"Text",command:e,type:"text",uiIcon:"note"},{title:"Code",command:e,type:"code",uiIcon:"code"},{title:"Saved search",command:e,type:"search",uiIcon:"file-find"},{title:"Relation Map",command:e,type:"relation-map",uiIcon:"map-alt"},{title:"Render HTML note",command:e,type:"render",uiIcon:"extension"},{title:"Book",command:e,type:"book",uiIcon:"book"}]}async getMenuItems(){const e=await a.Z.getNote(this.node.data.noteId),t=a.Z.getBranch(this.node.data.branchId),o="root"!==e.noteId,n=e.noteId===d.Z.getHoistedNoteId(),l=o?await a.Z.getNote(t.parentNoteId):null,m=this.treeWidget.getSelectedNodes(),s=0===m.length||1===m.length&&m[0]===this.node,r="search"!==e.type,b=!l||"search"!==l.type,p=o&&!n&&b;return[{title:"Open in a new tab <kbd>Ctrl+Click</kbd>",command:"openInTab",uiIcon:"empty",enabled:s},{title:"Open in a new window",command:"openInWindow",uiIcon:"window-open",enabled:s},{title:'Insert note after <kbd data-command="createNoteAfter"></kbd>',command:"insertNoteAfter",uiIcon:"plus",items:p?this.getNoteTypeItems("insertNoteAfter"):null,enabled:p&&s},{title:'Insert child note <kbd data-command="createNoteInto"></kbd>',command:"insertChildNote",uiIcon:"plus",items:r?this.getNoteTypeItems("insertChildNote"):null,enabled:r&&s},{title:'Delete <kbd data-command="deleteNotes"></kbd>',command:"deleteNotes",uiIcon:"trash",enabled:o&&!n&&b},{title:"----"},{title:'Search in subtree <kbd data-command="searchInSubtree"></kbd>',command:"searchInSubtree",uiIcon:"search",enabled:r&&s},n?null:{title:'Hoist note <kbd data-command="toggleNoteHoisting"></kbd>',command:"toggleNoteHoisting",uiIcon:"empty",enabled:s&&r},n&&o?{title:'Unhoist note <kbd data-command="ToggleNoteHoisting"></kbd>',command:"toggleNoteHoisting",uiIcon:"arrow-up"}:null,{title:'Edit branch prefix <kbd data-command="editBranchPrefix"></kbd>',command:"editBranchPrefix",uiIcon:"empty",enabled:o&&b&&s},{title:"Advanced",uiIcon:"empty",enabled:!0,items:[{title:'Expand subtree <kbd data-command="expandSubtree"></kbd>',command:"expandSubtree",uiIcon:"expand",enabled:s},{title:'Collapse subtree <kbd data-command="collapseSubtree"></kbd>',command:"collapseSubtree",uiIcon:"collapse",enabled:s},{title:"Force note sync",command:"forceNoteSync",uiIcon:"refresh",enabled:s},{title:'Sort alphabetically <kbd data-command="sortChildNotes"></kbd>',command:"sortChildNotes",uiIcon:"empty",enabled:s&&r},{title:"Recent changes in subtree",command:"recentChangesInSubtree",uiIcon:"history",enabled:s}]},{title:"----"},{title:"Protect subtree",command:"protectSubtree",uiIcon:"check-shield",enabled:s},{title:"Unprotect subtree",command:"unprotectSubtree",uiIcon:"shield",enabled:s},{title:"----"},{title:'Copy / clone <kbd data-command="copyNotesToClipboard"></kbd>',command:"copyNotesToClipboard",uiIcon:"copy",enabled:o&&!n},{title:'Clone to ... <kbd data-command="cloneNotesTo"></kbd>',command:"cloneNotesTo",uiIcon:"empty",enabled:o&&!n},{title:'Cut <kbd data-command="cutNotesToClipboard"></kbd>',command:"cutNotesToClipboard",uiIcon:"cut",enabled:o&&!n&&b},{title:'Move to ... <kbd data-command="moveNotesTo"></kbd>',command:"moveNotesTo",uiIcon:"empty",enabled:o&&!n&&b},{title:'Paste into <kbd data-command="pasteNotesFromClipboard"></kbd>',command:"pasteNotesFromClipboard",uiIcon:"paste",enabled:!i.Z.isClipboardEmpty()&&r&&s},{title:"Paste after",command:"pasteNotesAfterFromClipboard",uiIcon:"paste",enabled:!i.Z.isClipboardEmpty()&&o&&!n&&b&&s},{title:"Duplicate note here",command:"duplicateNote",uiIcon:"empty",enabled:s&&b&&o&&!n&&(!e.isProtected||c.Z.isProtectedSessionAvailable())},{title:"----"},{title:"Export",command:"exportNote",uiIcon:"empty",enabled:r&&s},{title:"Import into note",command:"importIntoNote",uiIcon:"empty",enabled:r&&s}].filter(e=>null!==e)}async selectMenuItemHandler({command:e,type:t}){const o=this.node.data.noteId,a=n.Z.getNotePath(this.node);if("openInTab"===e)l.default.tabManager.openTabWithNote(a);else if("insertNoteAfter"===e){const e=this.node.data.parentNoteId,o=await n.Z.getParentProtectedStatus(this.node);m.Z.createNote(e,{target:"after",targetBranchId:this.node.data.branchId,type:t,isProtected:o})}else"insertChildNote"===e?m.Z.createNote(o,{type:t,isProtected:this.node.data.isProtected}):this.treeWidget.triggerCommand(e,{node:this.node,notePath:a})}}}}]);
//# sourceMappingURL=893.desktop.js.map