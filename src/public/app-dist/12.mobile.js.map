{"version":3,"sources":["webpack://trilium/./src/public/app/dialogs/options/appearance.js"],"names":["ApperanceOptions","$","html","this","$themeSelect","$zoomFactorSelect","$nativeTitleBarSelect","$mainFontSize","$treeFontSize","$detailFontSize","$body","on","newTheme","val","clazz","Array","from","classList","startsWith","removeClass","noteId","find","attr","addClass","zoomFactor","nativeTitleBarVisible","async","applyFontSizes","options","themes","title","concat","empty","theme","append","prop","mainFontSize","treeFontSize","detailFontSize","get","style","setProperty"],"mappings":"8KAyEe,MAAMA,EACjB,cACIC,EAAE,uBAAuBC,KAtErB,25EAwEJC,KAAKC,aAAeH,EAAE,iBACtBE,KAAKE,kBAAoBJ,EAAE,uBAC3BE,KAAKG,sBAAwBL,EAAE,4BAC/BE,KAAKI,cAAgBN,EAAE,mBACvBE,KAAKK,cAAgBP,EAAE,mBACvBE,KAAKM,gBAAkBR,EAAE,qBACzBE,KAAKO,MAAQT,EAAE,QAEfE,KAAKC,aAAaO,GAAG,SAAU,KAC3B,MAAMC,EAAWT,KAAKC,aAAaS,MAEnC,IAAK,MAAMC,KAASC,MAAMC,KAAKb,KAAKO,MAAM,GAAGO,WACrCH,EAAMI,WAAW,WACjBf,KAAKO,MAAMS,YAAYL,GAI/B,MAAMM,EAASnB,EAAEE,MAAMkB,KAAK,aAAaC,KAAK,gBAE1CF,GAGA,eAAyB,sBAAsBA,GAGnDjB,KAAKO,MAAMa,SAAS,SAAWX,GAE/B,QAAW,iBAAmBA,KAGlCT,KAAKE,kBAAkBM,GAAG,SAAU,KAAQ,yBAA0B,uBAAwB,CAACa,WAAYrB,KAAKE,kBAAkBQ,UAElIV,KAAKG,sBAAsBK,GAAG,SAAU,KACpC,MAAMc,EAA6D,SAArCtB,KAAKG,sBAAsBO,MAAmB,OAAS,QAErF,QAAW,iCAAmCY,KAGlDtB,KAAKI,cAAcI,GAAG,SAAUe,gBACtB,QAAW,wBAA0BvB,KAAKI,cAAcM,OAE9DV,KAAKwB,mBAGTxB,KAAKK,cAAcG,GAAG,SAAUe,gBACtB,QAAW,wBAA0BvB,KAAKK,cAAcK,OAE9DV,KAAKwB,mBAGTxB,KAAKM,gBAAgBE,GAAG,SAAUe,gBACxB,QAAW,0BAA4BvB,KAAKM,gBAAgBI,OAElEV,KAAKwB,mBAIb,oBAAoBC,GAChB,MAAMC,EAAS,CACX,CAAEhB,IAAK,QAASiB,MAAO,SACvB,CAAEjB,IAAK,OAAQiB,MAAO,QACtB,CAAEjB,IAAK,QAASiB,MAAO,UACzBC,aAAa,QAAW,wBAE1B5B,KAAKC,aAAa4B,QAElB,IAAK,MAAMC,KAASJ,EAChB1B,KAAKC,aAAa8B,OAAOjC,EAAE,YACtBqB,KAAK,QAASW,EAAMpB,KACpBS,KAAK,eAAgBW,EAAMb,QAC3BlB,KAAK+B,EAAMH,QAGpB3B,KAAKC,aAAaS,IAAIe,EAAQK,OAE1B,iBACA9B,KAAKE,kBAAkBQ,IAAIe,EAAQJ,YAGnCrB,KAAKE,kBAAkB8B,KAAK,YAAY,GAG5ChC,KAAKG,sBAAsBO,IAAsC,SAAlCe,EAAQH,sBAAmC,OAAS,QAEnFtB,KAAKI,cAAcM,IAAIe,EAAQQ,cAC/BjC,KAAKK,cAAcK,IAAIe,EAAQS,cAC/BlC,KAAKM,gBAAgBI,IAAIe,EAAQU,gBAGrC,iBACInC,KAAKO,MAAM6B,IAAI,GAAGC,MAAMC,YAAY,mBAAoBtC,KAAKI,cAAcM,MAAQ,KACnFV,KAAKO,MAAM6B,IAAI,GAAGC,MAAMC,YAAY,mBAAoBtC,KAAKK,cAAcK,MAAQ,KACnFV,KAAKO,MAAM6B,IAAI,GAAGC,MAAMC,YAAY,qBAAsBtC,KAAKM,gBAAgBI,MAAQ","file":"12.mobile.js","sourcesContent":["import server from \"../../services/server.js\";\nimport utils from \"../../services/utils.js\";\nimport appContext from \"../../services/app_context.js\";\nimport libraryLoader from \"../../services/library_loader.js\";\n\nconst TPL = `\n<p><strong>Settings on this options tab are saved automatically after each change.</strong></p>\n\n<form>\n    <div class=\"form-group row\">\n        <div class=\"col-4\">\n            <label for=\"theme-select\">Theme</label>\n            <select class=\"form-control\" id=\"theme-select\"></select>\n        </div>\n\n        <div class=\"col-4\">\n            <label for=\"zoom-factor-select\">Zoom factor (desktop build only)</label>\n\n            <input type=\"number\" class=\"form-control\" id=\"zoom-factor-select\" min=\"0.3\" max=\"2.0\" step=\"0.1\"/>\n        </div>\n        \n        <div class=\"col-4\">\n            <label for=\"native-title-bar-select\">Native title bar (requires app restart)</label>\n\n            <select class=\"form-control\" id=\"native-title-bar-select\">\n                <option value=\"show\">enabled</option>\n                <option value=\"hide\">disabled</option>\n            </select>\n        </div>\n    </div>\n\n    <p>Zooming can be controlled with CTRL-+ and CTRL-= shortcuts as well.</p>\n\n    <h4>Font sizes</h4>\n\n    <div class=\"form-group row\">\n        <div class=\"col-4\">\n            <label for=\"main-font-size\">Main font size</label>\n\n            <div class=\"input-group\">\n                <input type=\"number\" class=\"form-control\" id=\"main-font-size\" min=\"50\" max=\"200\" step=\"10\"/>\n                <div class=\"input-group-append\">\n                    <span class=\"input-group-text\">%</span>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"col-4\">\n            <label for=\"tree-font-size\">Note tree font size</label>\n\n            <div class=\"input-group\">\n                <input type=\"number\" class=\"form-control\" id=\"tree-font-size\" min=\"50\" max=\"200\" step=\"10\"/>\n                <div class=\"input-group-append\">\n                    <span class=\"input-group-text\">%</span>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"col-4\">\n            <label for=\"detail-font-size\">Note detail font size</label>\n\n            <div class=\"input-group\">\n                <input type=\"number\" class=\"form-control\" id=\"detail-font-size\" min=\"50\" max=\"200\" step=\"10\"/>\n                <div class=\"input-group-append\">\n                    <span class=\"input-group-text\">%</span>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <p>Note that tree and detail font sizing is relative to the main font size setting.</p>\n</form>`;\n\nexport default class ApperanceOptions {\n    constructor() {\n        $(\"#options-appearance\").html(TPL);\n\n        this.$themeSelect = $(\"#theme-select\");\n        this.$zoomFactorSelect = $(\"#zoom-factor-select\");\n        this.$nativeTitleBarSelect = $(\"#native-title-bar-select\");\n        this.$mainFontSize = $(\"#main-font-size\");\n        this.$treeFontSize = $(\"#tree-font-size\");\n        this.$detailFontSize = $(\"#detail-font-size\");\n        this.$body = $(\"body\");\n\n        this.$themeSelect.on('change', () => {\n            const newTheme = this.$themeSelect.val();\n\n            for (const clazz of Array.from(this.$body[0].classList)) { // create copy to safely iterate over while removing classes\n                if (clazz.startsWith(\"theme-\")) {\n                    this.$body.removeClass(clazz);\n                }\n            }\n\n            const noteId = $(this).find(\":selected\").attr(\"data-note-id\");\n\n            if (noteId) {\n                // make sure the CSS is loaded\n                // if the CSS has been loaded and then updated then the changes won't take effect though\n                libraryLoader.requireCss(`api/notes/download/${noteId}`);\n            }\n\n            this.$body.addClass(\"theme-\" + newTheme);\n\n            server.put('options/theme/' + newTheme);\n        });\n\n        this.$zoomFactorSelect.on('change', () => { appContext.triggerCommand('setZoomFactorAndSave', {zoomFactor: this.$zoomFactorSelect.val()}); });\n\n        this.$nativeTitleBarSelect.on('change', () => {\n            const nativeTitleBarVisible = this.$nativeTitleBarSelect.val() === 'show' ? 'true' : 'false';\n\n            server.put('options/nativeTitleBarVisible/' + nativeTitleBarVisible);\n        });\n\n        this.$mainFontSize.on('change', async () => {\n            await server.put('options/mainFontSize/' + this.$mainFontSize.val());\n\n            this.applyFontSizes();\n        });\n\n        this.$treeFontSize.on('change', async () => {\n            await server.put('options/treeFontSize/' + this.$treeFontSize.val());\n\n            this.applyFontSizes();\n        });\n\n        this.$detailFontSize.on('change', async () => {\n            await server.put('options/detailFontSize/' + this.$detailFontSize.val());\n\n            this.applyFontSizes();\n        });\n    }\n\n    async optionsLoaded(options) {\n        const themes = [\n            { val: 'white', title: 'White' },\n            { val: 'dark', title: 'Dark' },\n            { val: 'black', title: 'Black' }\n        ].concat(await server.get('options/user-themes'));\n\n        this.$themeSelect.empty();\n\n        for (const theme of themes) {\n            this.$themeSelect.append($(\"<option>\")\n                .attr(\"value\", theme.val)\n                .attr(\"data-note-id\", theme.noteId)\n                .html(theme.title));\n        }\n\n        this.$themeSelect.val(options.theme);\n\n        if (utils.isElectron()) {\n            this.$zoomFactorSelect.val(options.zoomFactor);\n        }\n        else {\n            this.$zoomFactorSelect.prop('disabled', true);\n        }\n\n        this.$nativeTitleBarSelect.val(options.nativeTitleBarVisible === 'true' ? 'show' : 'hide');\n\n        this.$mainFontSize.val(options.mainFontSize);\n        this.$treeFontSize.val(options.treeFontSize);\n        this.$detailFontSize.val(options.detailFontSize);\n    }\n\n    applyFontSizes() {\n        this.$body.get(0).style.setProperty(\"--main-font-size\", this.$mainFontSize.val() + \"%\");\n        this.$body.get(0).style.setProperty(\"--tree-font-size\", this.$treeFontSize.val() + \"%\");\n        this.$body.get(0).style.setProperty(\"--detail-font-size\", this.$detailFontSize.val() + \"%\");\n    }\n}"],"sourceRoot":""}