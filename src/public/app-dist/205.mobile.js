(window.webpackJsonptrilium=window.webpackJsonptrilium||[]).push([[205],{8205:(e,t,o)=>{"use strict";o.r(t),o.d(t,{showDialog:()=>f});var n=o(6707),s=o(9800),a=o(6885),r=o(9046);const i=$("#sql-console-dialog"),c=$("#sql-console-query"),l=$("#sql-console-execute"),d=$("#sql-console-table-schemas"),p=$("#result-container");let u;async function f(){await async function(){const e=await s.Z.get("sql/schema");d.empty();for(const t of e){const e=$('<button class="btn">').text(t.name),o=$("<ul>");for(const e of t.columns)o.append($("<li>").append($("<span>").text(e.name)).append($("<span>").text(e.type)));d.append(e).append(" "),e.tooltip({html:!0,placement:"bottom",boundary:"window",title:o[0].outerHTML}).on("click",()=>u.setValue("SELECT * FROM "+t.name+" LIMIT 100"))}}(),r.Z.openDialog(i)}async function m(){let e=u.getSelection();e||(e=u.getValue());const t=await s.Z.post("sql/execute",{query:e});if(!t.success)return void a.default.showError(t.error);a.default.showMessage("Query was executed successfully.");const o=t.results;p.empty();for(const e of o){if(0===e.length)continue;const t=$('<table class="table table-striped">');p.append(t);const o=e[0],n=$("<tr>");for(const e in o)n.append($("<th>").html(e));t.append(n);for(const o of e){const e=$("<tr>");for(const t in o)e.append($("<td>").html(o[t]));t.append(e)}}}i.on("shown.bs.modal",e=>async function(){u||(await n.Z.requireLibrary(n.Z.CODE_MIRROR),CodeMirror.keyMap.default["Shift-Tab"]="indentLess",CodeMirror.keyMap.default.Tab="indentMore",delete CodeMirror.keyMap.basic.Esc,CodeMirror.modeURL="libraries/codemirror/mode/%N/%N.js",u=CodeMirror(c[0],{value:"",viewportMargin:1/0,indentUnit:4,highlightSelectionMatches:{showToken:/\w/,annotateScrollbar:!1}}),u.setOption("mode","text/x-sqlite"),CodeMirror.autoLoadMode(u,"sql"),u.setValue("SELECT title, isProtected, type, mime FROM notes WHERE noteId = 'root';\n---\nSELECT noteId, parentNoteId, notePosition, prefix FROM branches WHERE branchId = 'root';"));u.focus()}()),r.Z.bindElShortcut(c,"ctrl+return",m),l.on("click",m)}}]);
//# sourceMappingURL=205.mobile.js.map