(window.webpackJsonptrilium=window.webpackJsonptrilium||[]).push([[274],{1274:(e,t,s)=>{"use strict";s.r(t),s.d(t,{uploadFiles:()=>p,default:()=>l});var a=s(6885),o=s(9800),r=s(1520),n=s(9046),i=s(8003);async function p(e,t,s){if(0===t.length)return;const a=n.Z.randomString(10);let r,i=0;for(const n of t){i++;const p=new FormData;p.append("upload",n),p.append("taskId",a),p.append("last",i===t.length?"true":"false");for(const e in s)p.append(e,s[e]);({noteId:r}=await $.ajax({url:baseApiUrl+"notes/"+e+"/import",headers:o.Z.getHeaders(),data:p,dataType:"json",type:"POST",timeout:36e5,contentType:!1,processData:!1}))}}function d(e,t){return{id:e,title:"Import status",message:t,icon:"plus"}}r.Z.subscribeToMessages(async e=>{if("import"===e.taskType)if("task-error"===e.type)a.default.closePersistent(e.taskId),a.default.showError(e.message);else if("task-progress-count"===e.type)a.default.showPersistent(d(e.taskId,"Import in progress: "+e.progressCount));else if("task-succeeded"===e.type){const t=d(e.taskId,"Import finished successfully.");t.closeAfter=5e3,a.default.showPersistent(t),e.result.importedNoteId&&await i.default.tabManager.getActiveTabContext().setNote(e.result.importedNoteId)}});const l={uploadFiles:p}}}]);
//# sourceMappingURL=274.desktop.js.map