(window.webpackJsonptrilium=window.webpackJsonptrilium||[]).push([[205],{205:(e,s,r)=>{"use strict";r.r(s),r.d(s,{showDialog:()=>u});var o=r(707),t=r(800),i=r(885),a=r(46);const n=$("#sql-console-dialog"),c=$("#sql-console-query"),l=$("#sql-console-execute"),d=$("#sql-console-table-schemas"),m=$("#result-container");let p;async function u(){await async function(){const e=await t.Z.get("sql/schema");d.empty();for(const s of e){const e=$('<button class="btn">').text(s.name),r=$("<ul>");for(const e of s.columns)r.append($("<li>").append($("<span>").text(e.name)).append($("<span>").text(e.type)));d.append(e).append(" "),e.tooltip({html:!0,placement:"bottom",boundary:"window",title:r[0].outerHTML}).on("click",()=>p.setValue("SELECT * FROM "+s.name+" LIMIT 100"))}}(),a.Z.openDialog(n)}async function b(){let e=p.getSelection();e||(e=p.getValue());const s=await t.Z.post("sql/execute",{query:e});if(!s.success)return void i.default.showError(s.error);i.default.showMessage("Query was executed successfully.");const r=s.results;m.empty();for(const e of r){if(0===e.length)continue;const s=$('<table class="table table-striped">');m.append(s);const r=e[0],o=$("<tr>");for(const e in r)o.append($("<th>").html(e));s.append(o);for(const r of e){const e=$("<tr>");for(const s in r)e.append($("<td>").html(r[s]));s.append(e)}}}n.on("shown.bs.modal",e=>async function(){p||(await o.Z.requireLibrary(o.Z.CODE_MIRROR),CodeMirror.keyMap.default["Shift-Tab"]="indentLess",CodeMirror.keyMap.default.Tab="indentMore",delete CodeMirror.keyMap.basic.Esc,CodeMirror.modeURL="libraries/codemirror/mode/%N/%N.js",p=CodeMirror(c[0],{value:"",viewportMargin:1/0,indentUnit:4,highlightSelectionMatches:{showToken:/\w/,annotateScrollbar:!1}}),p.setOption("mode","text/x-sqlite"),CodeMirror.autoLoadMode(p,"sql"),p.setValue("SELECT title, isProtected, type, mime FROM notes WHERE noteId = 'root';\n---\nSELECT noteId, parentNoteId, notePosition, prefix FROM branches WHERE branchId = 'root';"));p.focus()}()),a.Z.bindElShortcut(c,"ctrl+return",b),l.on("click",b)},707:(e,s,r)=>{"use strict";r.d(s,{Z:()=>a});const o={};async function t(e){o[e]||(o[e]=$.ajax({url:e,dataType:"script",cache:!0})),await o[e]}async function i(e){Array.from(document.querySelectorAll("link")).map(e=>e.href).some(s=>s.endsWith(e))||$("head").append($('<link rel="stylesheet" type="text/css" />').attr("href",e))}const a={requireCss:i,requireLibrary:async function(e){if(e.css&&e.css.map(e=>i(e)),e.js)for(const s of e.js)await t(s)},CKEDITOR:{js:["libraries/ckeditor/ckeditor.js"]},CODE_MIRROR:{js:["libraries/codemirror/codemirror.js","libraries/codemirror/addon/mode/loadmode.js","libraries/codemirror/addon/fold/xml-fold.js","libraries/codemirror/addon/edit/matchbrackets.js","libraries/codemirror/addon/edit/matchtags.js","libraries/codemirror/addon/search/match-highlighter.js","libraries/codemirror/mode/meta.js","libraries/codemirror/addon/lint/lint.js","libraries/codemirror/addon/lint/eslint.js"],css:["libraries/codemirror/codemirror.css","libraries/codemirror/addon/lint/lint.css"]},ESLINT:{js:["libraries/eslint.js"]},COMMONMARK:{js:["libraries/commonmark.min.js"]},RELATION_MAP:{js:["libraries/jsplumb.js","libraries/panzoom.js"],css:["stylesheets/relation_map.css"]},LINK_MAP:{js:["libraries/jsplumb.js","libraries/panzoom.js","libraries/springy.js"],css:["stylesheets/link_map.css"]},PRINT_THIS:{js:["libraries/printThis.js"]},KNOCKOUT:{js:["libraries/knockout.min.js"]},CALENDAR_WIDGET:{css:["stylesheets/calendar.css"]}}}}]);
//# sourceMappingURL=205.setup.js.map